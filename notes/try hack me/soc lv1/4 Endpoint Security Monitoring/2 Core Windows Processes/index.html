
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://srt-ctf.zip/notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/">
      
      
        <link rel="prev" href="../1%20Intro%20to%20Endpoint%20Security/">
      
      
        <link rel="next" href="../3%20Sysinternals/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>2 Core Windows Processes - SRT-CTF.ZIP</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <script defer src="https://umami.raccoon-codlet.ts.net/script.js" data-website-id="7911a1ce-5e93-48ac-89a5-33ba1a0cd6ea" data-domains="srt-ctf.zip"></script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#system" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="SRT-CTF.ZIP" class="md-header__button md-logo" aria-label="SRT-CTF.ZIP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SRT-CTF.ZIP
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2 Core Windows Processes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="SRT-CTF.ZIP" class="md-nav__button md-logo" aria-label="SRT-CTF.ZIP" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SRT-CTF.ZIP
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/category/aoc23-sq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AOC23-SQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/category/ctf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../../blog/category/tryhackme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TryHackMe
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Try hack me
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Try hack me
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Soc lv1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Soc lv1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_2" id="__nav_3_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    1 Cyber Defence Frameworks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            1 Cyber Defence Frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Diamond Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1%20Cyber%20Defence%20Frameworks/6-MITRE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MITRE
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_3" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_3" id="__nav_3_1_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2 Cyber Threat Intelligence
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            2 Cyber Threat Intelligence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20Cyber%20Threat%20Intelligence/3-yara/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Yara
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20Cyber%20Threat%20Intelligence/4-OpenCTI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4 OpenCTI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20Cyber%20Threat%20Intelligence/5-MISP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5 MISP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20Cyber%20Threat%20Intelligence/6-fridayovertime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6 fridayovertime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2%20Cyber%20Threat%20Intelligence/7-trooper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7 trooper
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_4" >
        
          
          <label class="md-nav__link" for="__nav_3_1_1_4" id="__nav_3_1_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    3 Network Security and Traffic Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            3 Network Security and Traffic Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 Traffic Analysis Essentials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2 Snort
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_5" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1_5" id="__nav_3_1_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    4 Endpoint Security Monitoring
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            4 Endpoint Security Monitoring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1%20Intro%20to%20Endpoint%20Security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 Intro to Endpoint Security
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    2 Core Windows Processes
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    2 Core Windows Processes
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system" class="md-nav__link">
    <span class="md-ellipsis">
      System
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smssexe-session-manager-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      smss.exe (Session Manager Subsystem)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="smss.exe (Session Manager Subsystem)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csrssexe-client-server-runtime-process" class="md-nav__link">
    <span class="md-ellipsis">
      csrss.exe (Client Server Runtime Process)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csrss.exe (Client Server Runtime Process)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal_1" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_1" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-initialization-process-wininitexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Initialization Process, wininit.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Initialization Process, wininit.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal_2" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_2" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-control-manager-scm-or-servicesexe" class="md-nav__link">
    <span class="md-ellipsis">
      Service Control Manager (SCM) or services.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Control Manager (SCM) or services.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_3" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-host-host-process-for-windows-services-or-svchostexe" class="md-nav__link">
    <span class="md-ellipsis">
      Service Host (Host Process for Windows Services), or svchost.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Host (Host Process for Windows Services), or svchost.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_1" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_4" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-security-authority-subsystem-service-lsass" class="md-nav__link">
    <span class="md-ellipsis">
      Local Security Authority Subsystem Service (LSASS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Local Security Authority Subsystem Service (LSASS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_2" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_5" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-logon-winlogonexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Logon, winlogon.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Logon, winlogon.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_3" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_6" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-explorer-explorerexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Explorer, explorer.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Explorer, explorer.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_4" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3%20Sysinternals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3 Sysinternals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4%20Windows%20Event%20Logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4 Windows Event Logs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5%20Sysmon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5 Sysmon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6%20Osquery%20The%20Basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6 Osquery The Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../7%20Wazuh/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7 Wazuh
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8%20Monday%20Monitor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8 Monday Monitor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9%20Retracted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9 Retracted
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#system" class="md-nav__link">
    <span class="md-ellipsis">
      System
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smssexe-session-manager-subsystem" class="md-nav__link">
    <span class="md-ellipsis">
      smss.exe (Session Manager Subsystem)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="smss.exe (Session Manager Subsystem)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#csrssexe-client-server-runtime-process" class="md-nav__link">
    <span class="md-ellipsis">
      csrss.exe (Client Server Runtime Process)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="csrss.exe (Client Server Runtime Process)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal_1" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_1" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-initialization-process-wininitexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Initialization Process, wininit.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Initialization Process, wininit.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#normal_2" class="md-nav__link">
    <span class="md-ellipsis">
      Normal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_2" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-control-manager-scm-or-servicesexe" class="md-nav__link">
    <span class="md-ellipsis">
      Service Control Manager (SCM) or services.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Control Manager (SCM) or services.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_3" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#service-host-host-process-for-windows-services-or-svchostexe" class="md-nav__link">
    <span class="md-ellipsis">
      Service Host (Host Process for Windows Services), or svchost.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Service Host (Host Process for Windows Services), or svchost.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_1" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_4" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-security-authority-subsystem-service-lsass" class="md-nav__link">
    <span class="md-ellipsis">
      Local Security Authority Subsystem Service (LSASS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Local Security Authority Subsystem Service (LSASS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_2" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_5" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-logon-winlogonexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Logon, winlogon.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Logon, winlogon.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_3" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-unusual_6" class="md-nav__link">
    <span class="md-ellipsis">
      What is unusual?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#windows-explorer-explorerexe" class="md-nav__link">
    <span class="md-ellipsis">
      Windows Explorer, explorer.exe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows Explorer, explorer.exe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-normal_4" class="md-nav__link">
    <span class="md-ellipsis">
      What is normal?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>2 Core Windows Processes</h1>

<div><p><a href="https://tryhackme.com/room/btwindowsinternals">TryHackMe Room</a></p>
<p><a href="https://www.sans.org/posters/hunt-evil/">Poster Link</a></p>
<p><embed alt="" src="../SANS_DFPS_FOR508_v4.11_0624.pdf" style="min-height:70vh;width:100%" type="application/pdf"></embed></p>
<p>In this room, we will explore the core processes within a Windows system. This room aims to help you know and understand what normal behaviour within a Windows operating system is. This foundational knowledge will help you identify malicious processes running on an endpoint. </p>
<h2 id="system">System<a class="headerlink" href="#system" title="Permanent link">¶</a></h2>
<p>The first Windows process on the list is System. It was mentioned in a previous section that a PID for any given process is assigned at random, but that is not the case for the System process. The PID for System is always 4. What does this process do exactly?</p>
<blockquote>
<p>"The System process (process ID 4) is the home for a special kind of thread that runs only in kernel mode a kernel-mode system thread. System threads have all the attributes and contexts of regular user-mode threads (such as a hardware context, priority, and so on) but are different in that they run only in kernel-mode executing code loaded in system space, whether that is in Ntoskrnl.exe or in any other loaded device driver. In addition, system threads don't have a user process address space and hence must allocate any dynamic storage from operating system memory heaps, such as a paged or nonpaged pool."</p>
<p>Image Path: C:\Windows\system32\ntoskrnl.exe (NT OS Kernel)
Parent Process: System Idle Process (0)</p>
</blockquote>
<h2 id="smssexe-session-manager-subsystem">smss.exe (Session Manager Subsystem)<a class="headerlink" href="#smssexe-session-manager-subsystem" title="Permanent link">¶</a></h2>
<p>This process starts the kernel and user modes of the Windows subsystem. This subsystem includes win32k.sys (kernel mode), winsrv.dll (user mode), and csrss.exe (user mode). </p>
<p>Smss.exe starts csrss.exe (Windows subsystem) and wininit.exe in Session 0, an isolated Windows session for the operating system, and csrss.exe and winlogon.exe for Session 1, which is the user session. The first child instance creates child instances in new sessions, done by smss.exe copying itself into the new session and self-terminating. You can read more about this process here.</p>
<h3 id="normal">Normal<a class="headerlink" href="#normal" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\smss.exe</li>
<li>Parent Process:  System</li>
<li>Number of Instances:  One master instance and child instance per session. The child instance exits after creating the session.</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time for the master instance</li>
</ul>
</blockquote>
<h3 id="what-is-unusual">What is unusual?<a class="headerlink" href="#what-is-unusual" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>A different parent process other than System (4)</li>
<li>The image path is different from C:\Windows\System32</li>
<li>More than one running process. (children self-terminate and exit after each new session)</li>
<li>The running User is not the SYSTEM user</li>
<li>Unexpected registry entries for Subsystem</li>
</ul>
</blockquote>
<h2 id="csrssexe-client-server-runtime-process">csrss.exe (Client Server Runtime Process)<a class="headerlink" href="#csrssexe-client-server-runtime-process" title="Permanent link">¶</a></h2>
<p>user-mode side of the Windows subsystem. This process is always running and is critical to system operation. If this process is terminated by chance, it will result in system failure. This process is responsible for the Win32 console window and process thread creation and deletion. For each instance, csrsrv.dll, basesrv.dll, and winsrv.dll are loaded (along with others). </p>
<p>This process is also responsible for making the Windows API available to other processes, mapping drive letters, and handling the Windows shutdown process. You can read more about this process here.</p>
<h3 id="normal_1">Normal<a class="headerlink" href="#normal_1" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\csrss.exe</li>
<li>Parent Process:  Created by an instance of smss.exe</li>
<li>Number of Instances:  Two or more</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time for the first two instances (for Session 0 and 1). Start times for additional instances occur as new sessions are created, although only Sessions 0 and 1 are often created.</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_1">What is unusual?<a class="headerlink" href="#what-is-unusual_1" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>An actual parent process. (smss.exe calls this process and self-terminates)</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes masquerading as csrss.exe in plain sight</li>
<li>The user is not the SYSTEM user.</li>
</ul>
</blockquote>
<h2 id="windows-initialization-process-wininitexe">Windows Initialization Process, wininit.exe<a class="headerlink" href="#windows-initialization-process-wininitexe" title="Permanent link">¶</a></h2>
<p>responsible for launching services.exe (Service Control Manager), lsass.exe (Local Security Authority), and lsaiso.exe within Session 0. It is another critical Windows process that runs in the background, along with its child processes. </p>
<blockquote>
<p>Note: lsaiso.exe is a process associated with Credential Guard and KeyGuard. You will only see this process if Credential Guard is enabled. </p>
</blockquote>
<h3 id="normal_2">Normal<a class="headerlink" href="#normal_2" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\wininit.exe</li>
<li>Parent Process:  Created by an instance of smss.exe</li>
<li>Number of Instances:  One</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_2">What is unusual?<a class="headerlink" href="#what-is-unusual_2" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>An actual parent process. (smss.exe calls this process and self-terminates)</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>Multiple running instances</li>
<li>Not running as SYSTEM</li>
</ul>
</blockquote>
<h2 id="service-control-manager-scm-or-servicesexe">Service Control Manager (SCM) or services.exe<a class="headerlink" href="#service-control-manager-scm-or-servicesexe" title="Permanent link">¶</a></h2>
<p>Its primary responsibility is to handle system services: loading services, interacting with services and starting or ending services. It maintains a database that can be queried using a Windows built-in utility, sc.exe. </p>
<div class="highlight"><pre><span></span><code>C:\Users\Administrator&gt; sc.exe
DESCRIPTION:
        SC is a command line program used for communicating with the
        Service Control Manager and services.
USAGE:
        sc &lt;server&gt; [command] [service name] &lt;option1&gt; &lt;option2&gt;...
</code></pre></div>
<p>Information regarding services is stored in the registry, <code>HKLM\System\CurrentControlSet\Services.</code></p>
<p><img alt="" src="../cl8932yl.png"></p>
<p>When a user logs into a machine successfully, this process is responsible for setting the value of the Last Known Good control set (Last Known Good Configuration), <code>HKLM\System\Select\LastKnownGood</code>, to that of the CurrentControlSet. </p>
<p><img alt="" src="../z99co23v.png"></p>
<p>This process is the parent to several other key processes: svchost.exe, spoolsv.exe, msmpeng.exe, and dllhost.exe</p>
<h3 id="what-is-normal">What is normal?<a class="headerlink" href="#what-is-normal" title="Permanent link">¶</a></h3>
<p><img alt="Services.exe properties." src="../dfm656vu.png"></p>
<p><img alt="Services.exe properties (2)" src="../500jd6i4.png"></p>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\services.exe</li>
<li>Parent Process:  wininit.exe</li>
<li>Number of Instances:  One</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_3">What is unusual?<a class="headerlink" href="#what-is-unusual_3" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>A parent process other than wininit.exe</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>Multiple running instances</li>
<li>Not running as SYSTEM</li>
</ul>
</blockquote>
<h2 id="service-host-host-process-for-windows-services-or-svchostexe">Service Host (Host Process for Windows Services), or svchost.exe<a class="headerlink" href="#service-host-host-process-for-windows-services-or-svchostexe" title="Permanent link">¶</a></h2>
<p>responsible for hosting and managing Windows services. </p>
<p>The services running in this process are implemented as DLLs. The DLL to implement is stored in the registry for the service under the Parameters subkey in ServiceDLL. The full path is <code>HKLM\SYSTEM\CurrentControlSet\Services\SERVICE NAME\Parameters</code></p>
<p>Since svchost.exe will always have multiple running processes on any Windows system, this process has been a target for malicious use. Adversaries create malware to masquerade as this process and try to hide amongst the legitimate svchost.exe processes. They can name the malware svchost.exe or misspell it slightly, such as scvhost.exe. By doing so, the intention is to go under the radar. Another tactic is to install/call a malicious service (DLL).  </p>
<h3 id="what-is-normal_1">What is normal?<a class="headerlink" href="#what-is-normal_1" title="Permanent link">¶</a></h3>
<p><img alt="Svchost.exe properties" src="../9v3q7q67.png"></p>
<blockquote>
<ul>
<li>Image Path: %SystemRoot%\System32\svchost.exe</li>
<li>Parent Process: services.exe</li>
<li>Number of Instances: Many</li>
<li>User Account: Varies (SYSTEM, Network Service, Local Service) depending on the svchost.exe instance. In Windows 10, some instances run as the logged-in user.</li>
<li>Start Time: Typically within seconds of boot time. Other instances of svchost.exe can be started after boot.</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_4">What is unusual?<a class="headerlink" href="#what-is-unusual_4" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>A parent process other than services.exe</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>The absence of the -k parameter</li>
</ul>
</blockquote>
<h2 id="local-security-authority-subsystem-service-lsass">Local Security Authority Subsystem Service (LSASS)<a class="headerlink" href="#local-security-authority-subsystem-service-lsass" title="Permanent link">¶</a></h2>
<p>responsible for enforcing the security policy on the system. It verifies users logging on to a Windows computer or server, handles password changes, and creates access tokens. It also writes to the Windows Security Log.</p>
<p>It creates security tokens for SAM (Security Account Manager), AD (Active Directory), and NETLOGON. It uses authentication packages specified in <code>HKLM\System\CurrentControlSet\Control\Lsa.</code>
<img alt="alt text" src="../wfyf8mwh.png"></p>
<p>Lsass.exe is another process adversaries target. Common tools such as <strong>mimikatz</strong> are used to dump credentials, or adversaries mimic this process to hide in plain sight. Again, they do this by either naming their malware by this process name or simply misspelling the malware slightly. </p>
<h3 id="what-is-normal_2">What is normal?<a class="headerlink" href="#what-is-normal_2" title="Permanent link">¶</a></h3>
<p><img alt="Lsass.exe properties." src="../xbe48x8j.png"></p>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\lsass.exe</li>
<li>Parent Process:  wininit.exe</li>
<li>Number of Instances:  One</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_5">What is unusual?<a class="headerlink" href="#what-is-unusual_5" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>A parent process other than wininit.exe</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>Multiple running instances</li>
<li>Not running as SYSTEM</li>
</ul>
</blockquote>
<h2 id="windows-logon-winlogonexe">Windows Logon, winlogon.exe<a class="headerlink" href="#windows-logon-winlogonexe" title="Permanent link">¶</a></h2>
<p>responsible for handling the Secure Attention Sequence (SAS). It is the ALT+CTRL+DELETE key combination users press to enter their username &amp; password. </p>
<p>This process is also responsible for loading the user profile. It loads the user's NTUSER.DAT into HKCU, and userinit.exe loads the user's shell.
<img alt="alt text" src="../6u0tunjb.png"></p>
<h3 id="what-is-normal_3">What is normal?<a class="headerlink" href="#what-is-normal_3" title="Permanent link">¶</a></h3>
<p><img alt="alt text" src="../bhgq2r2l.png"></p>
<p>Winlogon properties (2).<img alt="alt text" src="../a2ai7c7s.png"></p>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\System32\winlogon.exe</li>
<li>Parent Process:  Created by an instance of smss.exe that exits, so analysis tools usually do not provide the parent process name.</li>
<li>Number of Instances:  One or more</li>
<li>User Account:  Local System</li>
<li>Start Time:  Within seconds of boot time for the first instance (for Session 1). Additional instances occur as new sessions are created, typically through Remote Desktop or Fast User Switching logons.</li>
</ul>
</blockquote>
<h3 id="what-is-unusual_6">What is unusual?<a class="headerlink" href="#what-is-unusual_6" title="Permanent link">¶</a></h3>
<blockquote>
<ul>
<li>An actual parent process. (smss.exe calls this process and self-terminates)</li>
<li>Image file path other than C:\Windows\System32</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>Not running as SYSTEM</li>
<li>Shell value in the registry other than explorer.exe</li>
</ul>
</blockquote>
<h2 id="windows-explorer-explorerexe">Windows Explorer, explorer.exe<a class="headerlink" href="#windows-explorer-explorerexe" title="Permanent link">¶</a></h2>
<p>gives the user access to their folders and files. It also provides functionality for other features, such as the Start Menu and Taskbar.</p>
<p>As mentioned previously, the Winlogon process runs userinit.exe, which launches the value in <code>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code>. Userinit.exe exits after spawning explorer.exe. Because of this, the parent process is non-existent. </p>
<p><img alt="There will be many child processes for explorer.exe." src="../cj3bmt02.png"></p>
<h3 id="what-is-normal_4">What is normal?<a class="headerlink" href="#what-is-normal_4" title="Permanent link">¶</a></h3>
<p><img alt="Explorer.exe properties." src="../ijs437nd.png"></p>
<blockquote>
<ul>
<li>Image Path:  %SystemRoot%\explorer.exe</li>
<li>Parent Process:  Created by userinit.exe and exits</li>
<li>Number of Instances:  One or more per interactively logged-in user</li>
<li>User Account:  Logged-in user(s)</li>
<li>Start Time:  First instance when the first interactive user logon session begins</li>
</ul>
</blockquote>
<p>What is unusual?</p>
<blockquote>
<ul>
<li>An actual parent process. (userinit.exe calls this process and exits)</li>
<li>Image file path other than C:\Windows</li>
<li>Running as an unknown user</li>
<li>Subtle misspellings to hide rogue processes in plain sight</li>
<li>Outbound TCP/IP connections</li>
</ul>
</blockquote>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">¶</a></h2>
<p>The information for this room is derived from multiple sources.</p>
<pre><code>https://0xcybery.github.io/blog/Core-Processes-In-Windows-System
https://www.sans.org/posters/hunt-evil/
https://docs.microsoft.com/en-us/sysinternals/resources/windows-internals
</code></pre>
<p>Other links are provided throughout the room. Reading them at your own leisure to further your foundation and understanding of the core Windows processes is encouraged.</p></div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["search.suggest"], "search": "../../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>
{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"About","text":""},{"location":"#about","title":"About","text":"<p>Hi, im SRT, SharpRaccoonTeeth, Ryan, that one raccoon you met at a hacker event </p> <p>anyway, this site is in development, im going to try and do more writeups for CTF content  or Blog content, i dont know.</p> <p>11/12/23 </p>"},{"location":"#events","title":"Events","text":""},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2023/12/11/the-return-of-the-yeti/","title":"The Return of the Yeti","text":"<p>I had the Advent of Cyber '23 on my calendar for Dec 1, and I wasn't sure what I was in for, this would be my first AOC, so, while I had some free time I logged the day before only to see there's another room released on my dashboard</p> <p></p> <p>ooh a Side Quest, I wonder if I can do something there while I wait for the main event</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#qr-code-social-media-finding-the-room","title":"QR code social media, finding the room","text":"<p>So in the try hack me Advent of Cyber '23 Side Quest room it says the first of four challenges will be a hidden room that you can get access to via QR code parts hidden in there social pages between Tuesday, 28th November and Thursday, 30th November, hey! today is the 30th, so I can go looking for them ahead of time and be prepared.</p> <p></p> <p>so lets get looking</p> <p>first I try there linked-in, scroll to find what was posted on the dates provided in the clue (between Tuesday, 28th November and Thursday, 30th November)</p> <p></p> <p>huh \ud83e\udd5a\ud83d\udc40 lets see what that link gets us</p> <p></p> <p>ahh, so its a bisected qr-code, I thought it would be multiple QR codes with data in them that you had to read, but this is interesting because if theres only one QR code maybe I can use the parts of it to figure out the rest, but first I should find what else is available</p> <p>well thay gave us a list, so lets follow it in order.</p> <p>There discord is up next, im already there so lets see whats up</p> <p></p> <p>a text channel made just for this room, lets see, pinned mesages</p> <p></p> <p>ooh nice, now there's only one more part relaced, socal media on the list no 3</p> <p>Instagram, oh well time to make a fake account so I can access the posts</p> <p>![note] instagram is being horrid, and while writeing this I wasnt able to get a screenshot never the less:</p> <p>ah ha here it is </p> <p>hmm ok so I have most of the qrcode, but not that top left section,</p> <p>lets see what each part dose and see if we can still get the data</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#repairing-the-qr-code-early","title":"repairing the qr code early","text":"<p>So, what is a qr code made of ?</p> <p>a quick google brought me here: https://www.maketecheasier.com/how-qr-codes-work/</p> <p></p> <p>mmhm mhmm, lots of reading, probably important,</p> <p>looks like im missing one of those positioning markers, the timeing data, format info, and \"content\" cool</p> <p>what is that though?</p> <p></p> <p>ok so, im missing error correction information and maybe some data too, or atleast part of it will be missing</p> <p>lest smooch what I have already together, and add in a marker and some timing pattens</p> <p></p> <p>k then, I cant decode that from my phone, there might be a tool to recover it maybe?</p> <p>google led me to this site https://merri.cx/qrazybox/ a qr code Analysis and Recovery Toolkit, noice</p> <p>what happens when I upload my art project to it?</p> <p></p> <p>detected nice, OOH tools, I like those</p> <p></p> <p>yes yes yes give me the data</p> <p></p> <p>wooo I did it yayyy</p> <p></p> <p>aww 302, redirect, shucks, wrong link. or at least its not entirely garbage, just something isnt right</p> <p>Lets sanity check first, is the room even there?</p> <p></p> <p>dms :</p> <p></p> <p>later in the main chat</p> <p></p> <p>alright then, lets see whats wrong with my qrcode</p> <p>lets look at that tool list and try something else, data sequence analysis, sounds good, I know some of the data is corrupt because it was split in 4 parts and I don't think an open bracket can be part of a URL</p> <p></p> <p>aah yeah, that message data is being read wrong because the missing data was just replaced with white or 0 values</p> <p>well the edit tool lets us paint each bit as either black 1, white 0, or Gray ?</p> <p>lets pain the missing bits and try to get the data again</p> <p></p> <p>yep missing data, lets see what we can use to help us, back in that tools section there was something called Reed-Soloman Decoder, used for \"errors and erasures correction\"</p> <p>now that sounds like a wikipedia rabbithole waiting to happen so ima ignore that and just press buttons and see what happens :3</p> <p></p> <p>well thats good, theres some reed-soloman blocks detected, lets try it</p> <p></p> <p>HA, pure skill, biggest brain ez no luck needed</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#into-the-room","title":"Into the room","text":"<p>and I'm the first person in the room 0w0</p> <p>![note] hi I'm currently writing this post bursting though this room, and didn't actually take any screen shots, but here's a time line from the room showing the 4 people to get into the room before the final part of the QR code is released  I got in at about 14:44 on the 30th, but I wasn't alone for long  </p> <p>I have to make use of this head start and get onto the tasks</p> <p>OK SO DONT PANIC, YOU MIGHT BE ABLE TO FINISH THIS ROOM BEFORE ANYONE ELSE</p> <p>what do we have (clue vision active)</p> <p></p> <p>and the questions</p> <p></p> <p>ooh a packet dump from a wifi connection, wireshark time :3</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#wireshark","title":"Wireshark","text":"<p>well thats question 1 done :3</p> <p></p> <p>\"What's the password to access the WiFi network?\"</p> <p>well we have alot of data here, and first thing I always do in Wireshark is get a higher level view of what's going on with its statistics tools, first thing first, what kind of data do we have, lets look at the protocol hierarchy</p> <p></p> <p></p> <p>ok lots of wifi stuff, lots of data, but most interestingly a little slither of 802.1x authentication stuff, lets filter for that useing the right click menus</p> <p></p> <p></p> <p>ooh nice, 2 4-way-handshake authentications, and its wep/wp2 ?</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#4-way-handshake","title":"4-way Handshake","text":"<p>google time and today we get : https://securitytutorials.co.uk/how-to-capture-crack-wpa-wpa2-wireless-passwords/</p> <p>nice. so we can use aircrack-ng to crack this, if I save it as a pcap format, and this is a ctf so its probably in the rockyou.txt wordlist</p> <p><code>aircrack-ng Downloads/van.pcap -w /usr/share/wordlists/rockyou.txt</code></p> <p> </p> <p></p> <p>heh nice, so lets put that into Wireshark to decrypt the traffic and go back to the protocol hierarchy to see what we have now</p> <p></p> <p>ok so some TCP data, alot is TLS encrypted, some is RDP, and some is just unencrypted data.</p> <p>lets look at this another way, now we have decrypted the 802.1x data, we should see addresses, so lets go to another one of the fue tools in Wireshark I know, the Conversations view</p> <p></p> <p>ok 3 devices, 8.8.8.8 is just googles dns so we can ignore that, whats going on in TCP land? and lets sort by packets so we see whats most chatty</p> <p></p> <p>ok so; lots of small packet examples that only last a tiny amount of time, from the same device, across alot of ports, so thats a packet scanner</p> <p>but the other two very chatty ports are 3389 and 4444 3389 is RDP so we were kind of expecting that, but whats 4444?</p> <p>cant find anything on google, lets look at the traffic</p> <p></p> <p></p> <p>oh hello is that the word power shell I see !</p> <p>lets follow the TCP stream</p> <p></p> <p></p> <p>oh someone has been very naughty this year</p> <p></p> <p>but thay did leave me a gift</p> <p></p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#rdp-certificate","title":"RDP Certificate","text":"<p>looks to be the local Remote Desktop certificate in base64 so lets reverse that with a tool provided to us by GCHQ! everyone's favourite CyberChef!</p> <p></p> <p>and hey presto, we get a certificate! and its got a password... less nice,</p> <p>I tried Christmas the wifi password, I tried BFC123, the password in the introtext, but no luck</p> <p>its at this point dear reader, that I realise someone else has joined the room and has answered all the questions I have, spooked, I want to get that first place!</p> <p>so I try cracking that certificate to try and read the RDP data and see what it could hold a bit of googling tells me that you can use john the ripper to crack a pkcs12</p> <p>so off I go crackin again, this is just a ctf so it should be relatively easy, just throw rockyou.txt at it, right?</p> <p>well after a long LONG time (1h)</p> <p></p> <p>GAAAH, I waited on all of rockyou and an hour of john brute-forceing just to get the word I already filled in for question 3  </p> <p>fine, we have the certificate, lets see what we get when we now decrypt the RDP traffic</p>"},{"location":"blog/2023/12/11/the-return-of-the-yeti/#rdp-clipbord","title":"RDP Clipbord","text":"<p>google powers fire up again i found this from unit42-palo altone tworks</p> <p>so lets get the key, then add it into wireshark</p> <p></p> <p>great, more layers of readable data, so lets look at the updated protocol hierarchy to see what we can read</p> <p></p> <p>ooh clipbord plaintext :3 lets sort this by length to try and find big chunks of text</p> <p></p> <p>ooh</p> <pre><code>anks for looking into this \nHaving Frost-eau in the case is for sure great!\nps I'll copy the weird file I found and send\n it to you through a more secure channel\n Regards\n Elf McSkidy\n</code></pre> <p>so something is getting sent and we can try to figure out whats happening though the clipbord text</p> <p>ill go though all of the 53 packets and try and pull out all the text in timeline order</p> <pre><code>https://mail.google.com/mail/u/0/?tab=rm&amp;ogbl**inbox**{: .hash}\n\n1337-0\n\nhanks for looking into this \nHaving Frost-eau in the case is for sure great!\nps I'll copy the weird file I found and send\n it to you through a more secure channel\n Regards\n Elf McSkidy\n\nyetikey1.txt\n\ndpxSet-Clipboard -value (Get-Content \\Desktop\\secret.txt.txt)\n\n1-1f9548f\n[REDACTED - you will have to do the room yourself to get this one]\n154ef2834\n</code></pre> <p>well that looks like the rest of our questions anscered</p> <p></p>"},{"location":"notes/try%20hack%20me/soc%20lv1/","title":"Index","text":"<ol> <li>Cyber Defence Frameworks<ol> <li>Junior Security Analyst Intro</li> <li>Pyramid Of Pain</li> <li>Cyber Kill Chain</li> <li>Unified Kill Chain</li> <li>Diamond Model</li> <li>MITRE</li> <li>summit</li> <li>Eviction </li> </ol> </li> <li> <p>Cyber Threat Intelligence</p> <ol> <li>Intro to Cyber Threat Intel</li> <li>Threat Intelligence Tools</li> <li>yara</li> <li>Open CTI</li> <li>MISP</li> <li>Friday Overtime</li> <li>Trooper</li> </ol> </li> <li> <p>Network Security and Traffic Analysis</p> <ol> <li>Traffic Analysis Essentials</li> <li>Snort</li> </ol> </li> <li>Endpoint Security Monitoring<ol> <li>Intro to Endpoint Security</li> <li>Core Windows Processes</li> <li>Sysinternals</li> <li>Windows Event Logs</li> <li>Sysmon</li> <li>Osquery The Basics</li> <li>Wazuh</li> <li>Monday Monitor</li> <li>Retracted</li> </ol> </li> </ol>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/","title":"The Diamond Model","text":"<p><code>SOC Level 1 &gt; Cyber Defence Frameworks &gt; Diamond Model</code></p> <p>four core features: </p> <ul> <li>adversary </li> <li>infrastructure</li> <li>capability</li> <li>victim</li> </ul> <p>## Adversary</p> <p>Adversary Operator is the \u201chacker\u201d or person(s) conducting the intrusion activity.</p> <p>Adversary Customer is the entity that stands to benefit from the activity conducted in the intrusion. It may be the same person who stands behind the adversary operator, or it may be a separate person or group.</p> <p>As an example, an adversary customer could control different operators simultaneously. Each operator might have its capabilities and infrastructure.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/#victim","title":"Victim","text":"<p>Victim Personae are the people and organizations being targeted and whose assets are being attacked and exploited. These can be organization names, people\u2019s names, industries, job roles, interests, etc.</p> <p>Victim Assets are the attack surface and include the set of systems, networks, email addresses, hosts, IP addresses, social networking accounts, etc., to which the adversary will direct their capabilities.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/#capability","title":"Capability","text":"<p>Capability Capacity is all of the vulnerabilities and exposures that the individual capability can use. </p> <p>An Adversary Arsenal is a set of capabilities that belong to an adversary. The combined capacities of an adversary's capabilities make it the adversary's arsenal.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/#infrastructure","title":"Infrastructure","text":"<p>Type 1:     infrastructure controlled or owned by the adversary</p> <p>Type 2:      controlled by an intermediary, Sometimes unaware, obfuscates the attribution      malware staging servers, malicious domain names, compromised email accounts, etc.</p> <p>Service Providers: services considered critical for the adversary availability of Type 1 and Type 2 Infrastructures, for example, Internet Service Providers, domain registrars, and webmail providers.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/5-Diamond_Model/#event-meta-features","title":"Event Meta Features","text":"<ul> <li>Timestamp </li> <li>Phase<ol> <li>Reconnaissance</li> <li>Weaponization</li> <li>Delivery</li> <li>Exploitation</li> <li>Installation</li> <li>Command &amp; Control</li> <li>Actions on Objective</li> </ol> </li> <li>Result </li> <li>Direction<ul> <li>Victim-to-Infrastructure, Infrastructure-to-Victim, Infrastructure-to-Infrastructure Est.</li> </ul> </li> <li>Methodology</li> <li>Resources </li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/","title":"MITRE","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#mitre","title":"MITRE","text":"<p>TTP: Tactics, Techniques, and Procedures - The  Tactic  is the adversary's goal or objective. - The  Technique  is how the adversary achieves the goal or objective. - The  Procedure  is how the technique is executed.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#attck","title":"ATT&amp;CK","text":"<p>( A dversarial  T actics,  T echniques,  and   C ommon  K nowledge) Framework</p> <p>Att&amp;ck website</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#car","title":"CAR","text":"<p>( C yber  A nalytics  R epository) Knowledge Base</p> <p>car website</p> <p>CAR defines a data model that is leveraged in its pseudocode representations, but also includes implementations directly targeted at specific tools (e.g., Splunk, EQL)</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#engage","title":"ENGAGE","text":"<p>MITRE Engage  is a framework for planning and discussing adversary engagement operations that empowers you to engage your adversaries and achieve your cybersecurity goals.</p> <p>With  Cyber Denial  we prevent the adversary's ability to conduct their operations and with  Cyber Deception  we intentionally plant artifacts to mislead the adversary. </p> <ul> <li>Prepare: the set of operational actions that will lead to your desired outcome (input)</li> <li>Expose: adversaries when they trigger your deployed deception activities </li> <li>Affect: adversaries by performing actions that will have a negative impact on their operations</li> <li>Elicit: information by observing the adversary and learn more about their modus operandi (TTPs)</li> <li>Understand: the outcomes of the operational actions (output) </li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#d3fend","title":"D3FEND","text":"<p>( Detection,  Denial, and  Disruption  Framework  Empowering  Network  Defense)</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/1%20Cyber%20Defence%20Frameworks/6-MITRE/#aep","title":"AEP","text":"<p>( A TT&amp;CK  E mulation  P lans)</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/","title":"Yara","text":"<p>All about Yara  \"The pattern matching swiss knife for malware researchers (and everyone else)\" (Virustotal., 2020)</p> <p>With such a fitting quote, Yara can identify information based on both binary and textual patterns, such as hexadecimal and strings contained within a file.</p> <p>Using a Yara rule is simple. Every yara command requires two arguments to be valid, these are: 1) The rule file we create 2) Name of file, directory, or process ID to use the rule for.</p> <p><code>$ yara myrule.yar somedirectory</code></p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#yara-rules","title":"Yara Rules","text":"<p>Anatomy of a Yara Rule </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#strings","title":"Strings","text":"<p>Single string  </p><pre><code>rule helloworld_checker{\n    strings:\n        $hello_world = \"Hello World!\"\n\n    condition:\n        $hello_world\n}\n</code></pre> <p>Any string  </p><pre><code>rule helloworld_checker{\n    strings:\n        $hello_world = \"Hello World!\"\n        $hello_world_lowercase = \"hello world\"\n        $hello_world_uppercase = \"HELLO WORLD\"\n\n    condition:\n        any of them\n}\n</code></pre>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#conditions","title":"Conditions","text":"<p>We have already used the true and any of them condition. Much like regular programming, you can use operators such as:</p> <pre><code>&lt;= (less than or equal to)\n&gt;= (more than or equal to)\n!= (not equal to)\n</code></pre> <p>For example, the rule below would do the following: </p><pre><code>rule helloworld_checker{\n    strings:\n        $hello_world = \"Hello World!\"\n\n    condition:\n        $hello_world &lt;= 10\n}\n</code></pre> <p>The rule will now:</p> <ol> <li>Look for the \"Hello World!\" string</li> <li>Only say the rule matches if there are less than or equal to ten occurrences of the \"Hello World!\" string</li> </ol>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#combining-keywords","title":"Combining keywords","text":"<p>Moreover, you can use keywords such as:</p> <pre><code>and\nnot\nor\n</code></pre> <pre><code>rule helloworld_checker{\n    strings:\n        $hello_world = \"Hello World!\" \n\n        condition:\n            $hello_world and filesize &lt; 10KB \n}\n</code></pre>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#resorces","title":"resorces","text":"<ul> <li>awesome-yara</li> <li>YAYA</li> <li>Fenrir</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#loki","title":"LOKI","text":"<p>LOKI is a free open-source IOC (Indicator of Compromise) scanner created/written by Florian Roth.</p> <p>Based on the GitHub page, detection is based on 4 methods:</p> <pre><code>File Name IOC Check\nYara Rule Check (we are here)\nHash Check\nC2 Back Connect Check\n</code></pre> <p>There are additional checks that LOKI can be used for. For a full rundown, please reference the GitHub readme.</p> <p>LOKI can be used on both Windows and Linux systems and can be downloaded here.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/3-yara/#valhalla","title":"valhalla","text":"<p>https://valhalla.nextron-systems.com/</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/4-OpenCTI/","title":"4 OpenCTI","text":"<p>https://filigran.io/solutions/open-cti/</p> <p>OpenCTI is another open-sourced platform designed to provide organisations with the means to manage CTI through the storage, analysis, visualisation and presentation of threat campaigns, malware and IOCs.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/5-MISP/","title":"5 MISP","text":"<p>MISP (Malware Information Sharing Platform) is an open-source threat information platform that facilitates the collection, storage and distribution of threat intelligence and Indicators of Compromise (IOCs) related to malware, cyber attacks, financial fraud or any intelligence within a community of trusted members. </p> <p>MISP is effectively useful for the following use cases:</p> <ul> <li>Malware Reverse Engineering: Sharing of malware indicators to understand how different malware families function.</li> <li>Security Investigations: Searching, validating and using indicators in investigating security breaches.</li> <li>Intelligence Analysis: Gathering information about adversary groups and their capabilities.</li> <li>Law Enforcement: Using Indicators to support forensic investigations.</li> <li>Risk Analysis: Researching new threats, their likelihood and occurrences.</li> <li>Fraud Analysis: Sharing of financial indicators to detect financial fraud.</li> </ul> <p>Functionalities:</p> <ul> <li>IOC database: This allows for the storage of technical and non-technical information about malware samples, incidents, attackers and intelligence.</li> <li>Automatic Correlation: Identification of relationships between attributes and indicators from malware, attack campaigns or analysis.</li> <li>Data Sharing: This allows for sharing of information using different models of distributions and among different MISP instances.</li> <li>Import &amp; Export Features: This allows the import and export of events in different formats to integrate other systems such as NIDS, HIDS, and OpenIOC.</li> <li>Event Graph: Showcases the relationships between objects and attributes identified from events.</li> <li>API support: Supports integration with own systems to fetch and export events and intelligence.</li> </ul> <p>The following terms are commonly used within MISP and are related to the functionalities described above and the general usage of the platform:</p> <ul> <li>Events: Collection of contextually linked information.</li> <li>Attributes: Individual data points associated with an event, such as network or system indicators.</li> <li>Objects: Custom attribute compositions.</li> <li>Object References: Relationships between different objects.</li> <li>Sightings: Time-specific occurrences of a given data point or attribute detected to provide more credibility.</li> <li>Tags: Labels attached to events/attributes.</li> <li>Taxonomies: Classification libraries are used to tag, classify and organise information.</li> <li>Galaxies: Knowledge base items used to label events/attributes.</li> <li>Indicators: Pieces of information that can detect suspicious or malicious cyber activity.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/6-fridayovertime/","title":"6 fridayovertime","text":"<p>It's a Friday evening at PandaProbe Intelligence when a notification appears on your CTI platform. While most are already looking forward to the weekend, you realise you must pull overtime because SwiftSpend Finance has opened a new ticket, raising concerns about potential malware threats. The finance company, known for its meticulous security measures, stumbled upon something suspicious and wanted immediate expert analysis.</p> <p>As the only remaining CTI Analyst on shift at PandaProbe Intelligence, you quickly took charge of the situation, realising the gravity of a potential breach at a financial institution. The ticket contained multiple file attachments, presumed to be malware samples.</p> <p>With a deep breath, a focused mind, and the longing desire to go home, you began the process of:</p> <ul> <li>Downloading the malware samples provided in the ticket, ensuring they were contained in a secure environment.</li> <li>Running the samples through preliminary automated malware analysis tools to get a quick overview.</li> <li>Deep diving into a manual analysis, understanding the malware's behaviour, and identifying its communication patterns.</li> <li>Correlating findings with global threat intelligence databases to identify known signatures or behaviours.</li> <li>Compiling a comprehensive report with mitigation and recovery steps, ensuring SwiftSpend Finance could swiftly address potential threats.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/6-fridayovertime/#_1","title":"6 fridayovertime","text":"<p>details </p> <p>9d1ecbbe863()35ea821277ad2e8  pRsm.dll</p> <p>used in mgbot</p> <p>pRsm.dll    Captures input and output audio streams.</p> <p>https://tryhackme.com/SharpRaccoonTeeth/badges/friday-fixer</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/2%20Cyber%20Threat%20Intelligence/7-trooper/","title":"7 trooper","text":"<p>A multinational technology company has been the target of several cyber attacks in the past few months. The attackers have been successful in stealing sensitive intellectual property and causing disruptions to the company's operations. A threat advisory report about similar attacks has been shared, and as a CTI analyst, your task is to identify the Tactics, Techniques, and Procedures (TTPs) being used by the Threat group and gather as much information as possible about their identity and motive. For this task, you will utilise the OpenCTI platform as well as the MITRE ATT&amp;CK navigator, linked to the details below. </p> <p>APT X Report</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/","title":"1 Traffic Analysis Essentials","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#base-network-security-control-levels","title":"Base Network Security Control Levels:","text":"<ul> <li>Physical: Physical security controls prevent unauthorised physical access to networking devices, cable boards, locks, and all linked components.</li> <li>Technical: Data security controls prevent unauthorised access to network data, like installing tunnels and implementing security layers.</li> <li>Administrative: Administrative security controls provide consistency in security operations like creating policies, access levels and authentication processes.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#the-main-approaches","title":"The main approaches:","text":"Access Control Threat Control The starting point of Network Security. It is a set of controls to ensure authentication and authorisation. Detecting and preventing anomalous/malicious activities on the network. It contains both internal (trusted) and external traffic data probes."},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#the-key-elements-of-access-control","title":"The key elements of Access Control:","text":"Firewall Protection Controls incoming and outgoing network traffic with predetermined security rules. Designed to block suspicious/malicious traffic and application-layer threats while allowing legitimate and expected traffic. Network Access Control (NAC) Controls the devices' suitability before access to the network. Designed to verify device specifications and conditions are compliant with the predetermined profile before connecting to the network. Identity and Access Management (IAM) Controls and manages the asset identities and user access to data systems and resources over the network. Load Balancing Controls the resource usage to distribute (based on metrics) tasks over a set of resources and improve overall data processing flow. Network Segmentation Creates and controls network ranges and segmentation to isolate the users' access levels, group assets with common functionalities, and improve the protection of sensitive/internal devices/data in a safer network. Virtual Private Networks (VPN) Creates and controls encrypted communication between devices (typically for secure remote access) over the network (including communications over the internet). Zero Trust Model Suggests configuring and implementing the access and permissions at a minimum level (providing access required to fulfil the assigned role). The mindset is focused on: \"Never trust, always verify\"."},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#the-key-elements-of-threat-control","title":"The key elements of Threat Control:","text":"<ul> <li>Intrusion Detection and Prevention (IDS/IPS)     Inspects the traffic and creates alerts (IDS) or resets the connection (IPS) when detecting an anomaly/threat.</li> <li>Data Loss Prevention (DLP)     Inspects the traffic (performs content inspection and contextual analysis of the data on the wire) and blocks the extraction of sensitive data.</li> <li>Endpoint Protection     Protecting all kinds of endpoints and appliances that connect to the network by using a multi-layered approach like encryption, antivirus, antimalware, DLP, and IDS/IPS.</li> <li>Cloud Security      Protecting cloud/online-based systems resources from threats and data leakage by applying suitable countermeasures like VPN and data encryption.</li> <li>Security Information and Event Management (SIEM)     Technology that helps threat detection, compliance, and security incident management, through available data (logs and traffic statistics) by using event and context analysis to identify anomalies, threats, and vulnerabilities.</li> <li>Security Orchestration Automation and Response (SOAR)     Technology that helps coordinate and automates tasks between various people, tools, and data within a single platform to identify anomalies, threats, and vulnerabilities. It also supports vulnerability management, incident response, and security operations.</li> <li>Network Traffic Analysis &amp; Network Detection and Response      Inspecting network traffic or traffic capture to identify anomalies and threats.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#typical-network-security-management-operation-is-explained-in-the-given-table","title":"Typical Network Security Management Operation is explained in the given table:","text":"Deployment Configuration Management Monitoring Maintenance - Device and software installation- Initial configuration- Automation - Feature configuration- Initial network access configuration - Security policy implementation- NAT and VPN implementation- Threat mitigation - System monitoring- User activity monitoring- Threat monitoring   - Log and traffic sample capturing - Upgrades- Security updates- Rule adjustments- Licence management- Configuration updates"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/1-Traffic%20Analysis%20Essentials/#traffic-analysis-network-traffic-analysis","title":"Traffic Analysis / Network Traffic Analysis","text":"<p>Traffic Analysis is a method of intercepting, recording/monitoring, and analysing network data and communication patterns to detect and respond to system health issues, network anomalies, and threats. The network is a rich data source, so traffic analysis is useful for security and operational matters.\u00a0The operational issues cover system availability checks and measuring performance, and the security issues cover anomaly and suspicious activity detection on the network.</p> <p>Traffic analysis is one of the essential approaches used in network security, and it is part of multiple disciplines of network security operations listed below:</p> <ul> <li>Network Sniffing and Packet Analysis (Covered in Wireshark room)</li> <li>Network Monitoring (Covered in\u00a0Zeek room)</li> <li>Intrusion Detection and Prevention (Covered in Snort room)  </li> <li>Network Forensics (Covered in NetworkMiner room)</li> <li>Threat Hunting (Covered in Brim room)</li> </ul> <p>There are two main techniques used in Traffic Analysis:</p> Flow Analysis Packet Analysis Collecting data/evidence from the networking devices. This type of analysis aims to provide statistical results through the data summary without applying in-depth packet-level investigation.- Advantage: Easy to collect and analyse.- Challenge: Doesn't provide full packet details to get the root cause of a case. Collecting all available network data. Applying in-depth packet-level investigation (often called Deep Packet Inspection (DPI) ) to detect and block anomalous and malicious packets.- Advantage: Provides full packet details to get the root cause of a case.- Challenge: Requires time and skillset to analyse."},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/","title":"2 Snort","text":"<p>SNORT is an open-source, rule-based Network Intrusion Detection and Prevention System (NIDS/NIPS) . It was developed and still maintained by Martin Roesch, open-source contributors, and the Cisco Talos team.  The official description: \"Snort is the foremost Open Source Intrusion Prevention System (IPS) in the world. Snort IPS uses a series of rules that help define malicious network activity and uses those rules to find packets that match against them and generate alerts for users.\" </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#introduction-to-idsips","title":"Introduction to IDS/IPS","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#intrusion-detection-system-ids","title":"Intrusion Detection System (IDS)","text":"<p>IDS is a passive monitoring solution for detecting possible malicious activities/patterns, abnormal incidents, and policy violations. It is responsible for generating alerts for each suspicious event. </p> <p>IDS Systems:  - Network Intrusion Detection System (NIDS)      - NIDS monitors the traffic flow from various areas of the network. The aim is to investigate the traffic on the entire subnet. If a signature is identified, an alert is created. - Host-based Intrusion Detection System (HIDS)     - HIDS monitors the traffic flow from a single endpoint device. The aim is to investigate the traffic on a particular device. If a signature is identified, an alert is created.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#intrusion-prevention-system-ips","title":"Intrusion Prevention System (IPS)","text":"<p>IPS is an active protecting solution for preventing possible malicious activities/patterns, abnormal incidents, and policy violations. It is responsible for stopping/preventing/terminating the suspicious event as soon as the detection is performed. </p> <p>Types of IPS:</p> <ul> <li>Network Intrusion Prevention System (NIPS) <ul> <li>NIPS monitors the traffic flow from various areas of the network. The aim is to protect the traffic on the entire subnet. If a signature is identified, the connection is terminated. </li> </ul> </li> <li>Behaviour-based Intrusion Prevention System (Network Behaviour Analysis - NBA) <ul> <li>Behaviour-based systems monitor the traffic flow from various areas of the network. The aim is to protect the traffic on the entire subnet. If an anomaly is identified, the connection is terminated.</li> </ul> </li> <li>Wireless Intrusion Prevention System (WIPS) <ul> <li>WIPS monitors the traffic flow from of wireless network. The aim is to protect the wireless traffic and stop possible attacks launched from there. If a signature is identified, the connection is terminated. </li> </ul> </li> <li>Host-based Intrusion Prevention System (HIPS) <ul> <li>HIPS actively protects the traffic flow from a single endpoint device. The aim is to investigate the traffic on a particular device. If a signature is identified, the connection is terminated. </li> </ul> </li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#detectionprevention-techniques","title":"Detection/Prevention Techniques","text":"<p>There are three main detection and prevention techniques used in IDS and IPS solutions; Technique   Approach</p> Signature-Based This technique relies on rules that identify the specific patterns of the known malicious behaviour. This model helps detect known threats. Behaviour-Based This technique identifies new threats with new patterns that pass through signatures. The model compares the known/normal with unknown/abnormal behaviours. This model helps detect previously unknown or new threats. Policy-Based This technique compares detected activities with system configuration and security policies. This model helps detect policy violations."},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#first-interaction-with-snort","title":"First Interaction with Snort","text":"<p><code>sudo snort -c /etc/snort/snort.conf</code></p>"},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#operation-mode-1-sniffer-mode","title":"Operation Mode 1: Sniffer Mode","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#operation-mode-2-packet-logger-mode","title":"Operation Mode 2: Packet Logger Mode","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#operation-mode-3-idsips","title":"Operation Mode 3: IDS/IPS","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#operation-mode-4-pcap-investigation","title":"Operation Mode 4: PCAP Investigation","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#snort-rule-structure","title":"Snort Rule Structure","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/3%20Network%20Security%20and%20Traffic%20Analysis/2-Snort/#snort2-operation-logic-points-to-remember","title":"Snort2 Operation Logic: Points to Remember","text":"<p>Snort-TryHackme</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/1%20Intro%20to%20Endpoint%20Security/","title":"1 Intro to Endpoint Security","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/","title":"2 Core Windows Processes","text":"<p>TryHackMe Room</p> <p>Poster Link</p> <p></p> <p>In this room, we will explore the core processes within a Windows system. This room aims to help you know and understand what normal behaviour within a Windows operating system is. This foundational knowledge will help you identify malicious processes running on an endpoint. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#system","title":"System","text":"<p>The first Windows process on the list is System. It was mentioned in a previous section that a PID for any given process is assigned at random, but that is not the case for the System process. The PID for System is always 4. What does this process do exactly?</p> <p>\"The System process (process ID 4) is the home for a special kind of thread that runs only in kernel mode a kernel-mode system thread. System threads have all the attributes and contexts of regular user-mode threads (such as a hardware context, priority, and so on) but are different in that they run only in kernel-mode executing code loaded in system space, whether that is in Ntoskrnl.exe or in any other loaded device driver. In addition, system threads don't have a user process address space and hence must allocate any dynamic storage from operating system memory heaps, such as a paged or nonpaged pool.\"</p> <p>Image Path: C:\\Windows\\system32\\ntoskrnl.exe (NT OS Kernel) Parent Process: System Idle Process (0)</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#smssexe-session-manager-subsystem","title":"smss.exe (Session Manager Subsystem)","text":"<p>This process starts the kernel and user modes of the Windows subsystem. This subsystem includes win32k.sys (kernel mode), winsrv.dll (user mode), and csrss.exe (user mode). </p> <p>Smss.exe starts csrss.exe (Windows subsystem) and wininit.exe in Session 0, an isolated Windows session for the operating system, and csrss.exe and winlogon.exe for Session 1, which is the user session. The first child instance creates child instances in new sessions, done by smss.exe copying itself into the new session and self-terminating. You can read more about this process here.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#normal","title":"Normal","text":"<ul> <li>Image Path:  %SystemRoot%\\System32\\smss.exe</li> <li>Parent Process:  System</li> <li>Number of Instances:  One master instance and child instance per session. The child instance exits after creating the session.</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time for the master instance</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual","title":"What is unusual?","text":"<ul> <li>A different parent process other than System (4)</li> <li>The image path is different from C:\\Windows\\System32</li> <li>More than one running process. (children self-terminate and exit after each new session)</li> <li>The running User is not the SYSTEM user</li> <li>Unexpected registry entries for Subsystem</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#csrssexe-client-server-runtime-process","title":"csrss.exe (Client Server Runtime Process)","text":"<p>user-mode side of the Windows subsystem. This process is always running and is critical to system operation. If this process is terminated by chance, it will result in system failure. This process is responsible for the Win32 console window and process thread creation and deletion. For each instance, csrsrv.dll, basesrv.dll, and winsrv.dll are loaded (along with others). </p> <p>This process is also responsible for making the Windows API available to other processes, mapping drive letters, and handling the Windows shutdown process. You can read more about this process here.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#normal_1","title":"Normal","text":"<ul> <li>Image Path:  %SystemRoot%\\System32\\csrss.exe</li> <li>Parent Process:  Created by an instance of smss.exe</li> <li>Number of Instances:  Two or more</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time for the first two instances (for Session 0 and 1). Start times for additional instances occur as new sessions are created, although only Sessions 0 and 1 are often created.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_1","title":"What is unusual?","text":"<ul> <li>An actual parent process. (smss.exe calls this process and self-terminates)</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes masquerading as csrss.exe in plain sight</li> <li>The user is not the SYSTEM user.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#windows-initialization-process-wininitexe","title":"Windows Initialization Process, wininit.exe","text":"<p>responsible for launching services.exe (Service Control Manager), lsass.exe (Local Security Authority), and lsaiso.exe within Session 0. It is another critical Windows process that runs in the background, along with its child processes. </p> <p>Note: lsaiso.exe is a process associated with Credential Guard and KeyGuard. You will only see this process if Credential Guard is enabled. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#normal_2","title":"Normal","text":"<ul> <li>Image Path:  %SystemRoot%\\System32\\wininit.exe</li> <li>Parent Process:  Created by an instance of smss.exe</li> <li>Number of Instances:  One</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_2","title":"What is unusual?","text":"<ul> <li>An actual parent process. (smss.exe calls this process and self-terminates)</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>Multiple running instances</li> <li>Not running as SYSTEM</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#service-control-manager-scm-or-servicesexe","title":"Service Control Manager (SCM) or services.exe","text":"<p>Its primary responsibility is to handle system services: loading services, interacting with services and starting or ending services. It maintains a database that can be queried using a Windows built-in utility, sc.exe. </p> <pre><code>C:\\Users\\Administrator&gt; sc.exe\nDESCRIPTION:\n        SC is a command line program used for communicating with the\n        Service Control Manager and services.\nUSAGE:\n        sc &lt;server&gt; [command] [service name] &lt;option1&gt; &lt;option2&gt;...\n</code></pre> <p>Information regarding services is stored in the registry, <code>HKLM\\System\\CurrentControlSet\\Services.</code></p> <p></p> <p>When a user logs into a machine successfully, this process is responsible for setting the value of the Last Known Good control set (Last Known Good Configuration), <code>HKLM\\System\\Select\\LastKnownGood</code>, to that of the CurrentControlSet. </p> <p></p> <p>This process is the parent to several other key processes: svchost.exe, spoolsv.exe, msmpeng.exe, and dllhost.exe</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-normal","title":"What is normal?","text":"<ul> <li>Image Path:  %SystemRoot%\\System32\\services.exe</li> <li>Parent Process:  wininit.exe</li> <li>Number of Instances:  One</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_3","title":"What is unusual?","text":"<ul> <li>A parent process other than wininit.exe</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>Multiple running instances</li> <li>Not running as SYSTEM</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#service-host-host-process-for-windows-services-or-svchostexe","title":"Service Host (Host Process for Windows Services), or svchost.exe","text":"<p>responsible for hosting and managing Windows services. </p> <p>The services running in this process are implemented as DLLs. The DLL to implement is stored in the registry for the service under the Parameters subkey in ServiceDLL. The full path is <code>HKLM\\SYSTEM\\CurrentControlSet\\Services\\SERVICE NAME\\Parameters</code></p> <p>Since svchost.exe will always have multiple running processes on any Windows system, this process has been a target for malicious use. Adversaries create malware to masquerade as this process and try to hide amongst the legitimate svchost.exe processes. They can name the malware svchost.exe or misspell it slightly, such as scvhost.exe. By doing so, the intention is to go under the radar. Another tactic is to install/call a malicious service (DLL).  </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-normal_1","title":"What is normal?","text":"<ul> <li>Image Path: %SystemRoot%\\System32\\svchost.exe</li> <li>Parent Process: services.exe</li> <li>Number of Instances: Many</li> <li>User Account: Varies (SYSTEM, Network Service, Local Service) depending on the svchost.exe instance. In Windows 10, some instances run as the logged-in user.</li> <li>Start Time: Typically within seconds of boot time. Other instances of svchost.exe can be started after boot.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_4","title":"What is unusual?","text":"<ul> <li>A parent process other than services.exe</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>The absence of the -k parameter</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#local-security-authority-subsystem-service-lsass","title":"Local Security Authority Subsystem Service (LSASS)","text":"<p>responsible for enforcing the security policy on the system. It verifies users logging on to a Windows computer or server, handles password changes, and creates access tokens. It also writes to the Windows Security Log.</p> <p>It creates security tokens for SAM (Security Account Manager), AD (Active Directory), and NETLOGON. It uses authentication packages specified in <code>HKLM\\System\\CurrentControlSet\\Control\\Lsa.</code> </p> <p>Lsass.exe is another process adversaries target. Common tools such as mimikatz are used to dump credentials, or adversaries mimic this process to hide in plain sight. Again, they do this by either naming their malware by this process name or simply misspelling the malware slightly. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-normal_2","title":"What is normal?","text":"<ul> <li>Image Path:  %SystemRoot%\\System32\\lsass.exe</li> <li>Parent Process:  wininit.exe</li> <li>Number of Instances:  One</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_5","title":"What is unusual?","text":"<ul> <li>A parent process other than wininit.exe</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>Multiple running instances</li> <li>Not running as SYSTEM</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#windows-logon-winlogonexe","title":"Windows Logon, winlogon.exe","text":"<p>responsible for handling the Secure Attention Sequence (SAS). It is the ALT+CTRL+DELETE key combination users press to enter their username &amp; password. </p> <p>This process is also responsible for loading the user profile. It loads the user's NTUSER.DAT into HKCU, and userinit.exe loads the user's shell. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-normal_3","title":"What is normal?","text":"<p>Winlogon properties (2).</p> <ul> <li>Image Path:  %SystemRoot%\\System32\\winlogon.exe</li> <li>Parent Process:  Created by an instance of smss.exe that exits, so analysis tools usually do not provide the parent process name.</li> <li>Number of Instances:  One or more</li> <li>User Account:  Local System</li> <li>Start Time:  Within seconds of boot time for the first instance (for Session 1). Additional instances occur as new sessions are created, typically through Remote Desktop or Fast User Switching logons.</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-unusual_6","title":"What is unusual?","text":"<ul> <li>An actual parent process. (smss.exe calls this process and self-terminates)</li> <li>Image file path other than C:\\Windows\\System32</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>Not running as SYSTEM</li> <li>Shell value in the registry other than explorer.exe</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#windows-explorer-explorerexe","title":"Windows Explorer, explorer.exe","text":"<p>gives the user access to their folders and files. It also provides functionality for other features, such as the Start Menu and Taskbar.</p> <p>As mentioned previously, the Winlogon process runs userinit.exe, which launches the value in <code>HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell</code>. Userinit.exe exits after spawning explorer.exe. Because of this, the parent process is non-existent. </p> <p></p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#what-is-normal_4","title":"What is normal?","text":"<ul> <li>Image Path:  %SystemRoot%\\explorer.exe</li> <li>Parent Process:  Created by userinit.exe and exits</li> <li>Number of Instances:  One or more per interactively logged-in user</li> <li>User Account:  Logged-in user(s)</li> <li>Start Time:  First instance when the first interactive user logon session begins</li> </ul> <p>What is unusual?</p> <ul> <li>An actual parent process. (userinit.exe calls this process and exits)</li> <li>Image file path other than C:\\Windows</li> <li>Running as an unknown user</li> <li>Subtle misspellings to hide rogue processes in plain sight</li> <li>Outbound TCP/IP connections</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/2%20Core%20Windows%20Processes/#conclusion","title":"Conclusion","text":"<p>The information for this room is derived from multiple sources.</p> <pre><code>https://0xcybery.github.io/blog/Core-Processes-In-Windows-System\nhttps://www.sans.org/posters/hunt-evil/\nhttps://docs.microsoft.com/en-us/sysinternals/resources/windows-internals\n</code></pre> <p>Other links are provided throughout the room. Reading them at your own leisure to further your foundation and understanding of the core Windows processes is encouraged.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/","title":"3 Sysinternals","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#file-and-disk-utilities","title":"File and Disk Utilities","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#sigcheck","title":"Sigcheck","text":"<p>shows file version number, timestamp information, and digital signature details, including certificate chains. It also includes an option to check a file\u2019s status on VirusTotal</p> <p>Use Case: Check for unsigned files in C:\\Windows\\System32.</p> <p>Command: <code>sigcheck -u -e C:\\Windows\\System32</code></p> <ul> <li><code>-u</code> \"If VirusTotal check is enabled, show files that are unknown by VirusTotal or have non-zero detection, otherwise show only unsigned files.\"</li> <li><code>-e</code> \"Scan executable images only (regardless of their extension)\"</li> </ul>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#streams","title":"Streams","text":"<p>\"The NTFS file system provides applications the ability to create alternate data streams of information. By default, all data is stored in a file's main unnamed data stream, but by using the syntax 'file:stream', you are able to read and write to alternates.\" (official definition)</p> <p>Alternate Data Streams (ADS) is a file attribute specific to Windows NTFS (New Technology File System). Every file has at least one data stream ($DATA) and ADS allows files to contain more than one stream of data. Natively Window Explorer doesn't display ADS to the user. There are 3rd party executables that can be used to view this data, but Powershell gives you the ability to view ADS for files.</p> <p>Malware writers have used ADS to hide data in an endpoint, but not all its uses are malicious. When you download a file from the Internet unto an endpoint, there are identifiers written to ADS to identify that it was downloaded from the Internet.</p> <p>Screenshot showing the execution of streams using the command prompt  Example: A file downloaded from the Internet.</p> <p>Screenshot showing the execution of streams against SysinternalsSuite.zip </p> <p>Since the file has this identifier, additional security measures are added to its properties.</p> <p>Screenshot showing the file properties of SysinternalsSuite.zip  You can read more on streams here. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#networking-utilities","title":"Networking Utilities","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#tcpview","title":"TCPView","text":"<p>TCPView is a Windows program that will show you detailed listings of all TCP and UDP endpoints on your system, including the local and remote addresses and state of TCP connections. On Windows Server 2008, Vista, and XP, TCPView also reports the name of the process that owns the endpoint. TCPView provides a more informative and conveniently presented subset of the Netstat program that ships with Windows. The TCPView download includes Tcpvcon, a command-line version with the same functionality.</p> <p>The below image shows the default view for TCPView. </p> <p>We can apply additional filtering by turning off TCP v4, TCP v6, UDP v4, and UDP v6 at the top toolbar, depending on which protocols we want to display. Moreover, we can click on the green flag to use the States Filter. </p> <p>Clicking the green flag opens the States Filter, which provides an extensive list of options to select which connection states we want to display. Most of the connection states available apply only to TCP connections. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#process-utilities","title":"Process Utilities","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#procdump","title":"ProcDump","text":"<p>\"ProcDump is a command-line utility whose primary purpose is monitoring an application for CPU spikes and generating crash dumps during a spike that an administrator or developer can use to determine the cause of the spike.\" (official definition) </p> <p>Alternatively, you can use Process Explorer to do the same.</p> <p>Right-click on the process to create a Minidump or Full Dump of the process.  Screenshot showing the Create Dump option after right clicking on a process</p> <p>Please refer to the examples listed on the ProcDump page to learn about all the available options with running this tool. </p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#autoruns","title":"Autoruns","text":"<p>\"This utility, which has the most comprehensive knowledge of auto-starting locations of any startup monitor, shows you what programs are configured to run during system bootup or login, and when you start various built-in Windows applications like Internet Explorer, Explorer and media players. These programs and drivers include ones in your startup folder, Run, RunOnce, and other Registry keys. Autoruns reports Explorer shell extensions, toolbars, browser helper objects, Winlogon notifications, auto-start services, and much more. Autoruns goes way beyond other autostart utilities.\" </p> <p>This is a good tool to search for any malicious entries created in the local machine to establish Persistence.</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#security-utilities","title":"Security Utilities","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#sysmon","title":"Sysmon","text":"<p>\"System Monitor (Sysmon) is a Windows system service and device driver that, once installed on a system, remains resident across system reboots to monitor and log system activity to the Windows event log. It provides detailed information about process creations, network connections, and changes to file creation time. By collecting the events it generates using Windows Event Collection or SIEM agents and subsequently analyzing them, you can identify malicious or anomalous activity and understand how intruders and malware operate on your network.\"</p> <p>Sysmon is a comprehensive tool, and it can't be summarized in just one section.</p> <p>Check out the Sysmon  room</p> <p> to further learn what Sysmon is and how to use it.</p> <p>Link: https://docs.microsoft.com/en-us/sysinternals/downloads/security-utilities</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#system-information","title":"System Information","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#winobj","title":"WinObj","text":"<p>\"WinObj is a 32-bit Windows NT program that uses the native Windows NT API (provided by NTDLL.DLL) to access and display information on the NT Object Manager's name space.\"</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/3%20Sysinternals/#miscellaneous","title":"Miscellaneous","text":""},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/4%20Windows%20Event%20Logs/","title":"4 Windows Event Logs","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/5%20Sysmon/","title":"5 Sysmon","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/6%20Osquery%20The%20Basics/","title":"6 Osquery The Basics","text":"<p>TryhackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/7%20Wazuh/","title":"7 Wazuh","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/8%20Monday%20Monitor/","title":"8 Monday Monitor","text":"<p>TryHackMe Room</p>"},{"location":"notes/try%20hack%20me/soc%20lv1/4%20Endpoint%20Security%20Monitoring/9%20Retracted/","title":"9 Retracted","text":"<p>TryHackMe Room</p>"},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/ctf/","title":"CTF","text":""},{"location":"blog/category/tryhackme/","title":"TryHackMe","text":""},{"location":"blog/category/aoc23-sq/","title":"AOC23-SQ","text":""}]}